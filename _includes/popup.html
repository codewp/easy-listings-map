<div class="popup" data-popup="popup-1">
    <div class="popup-inner">
    	<p id="popup-message" style="display: none;"></p>
        <h2>Subscribe via email</h2>
        <p>Subscribe for getting free PDF version of Easy Listings Map documentation and update news about Easy Listings Map.</p>
        <input type="text" class="popup-input" name="name" placeholder="Name" id="name">
        <input type="email" class="popup-input" name="email" placeholder="Email" id="email">
    	<input class="emerald-flat-button" type="button" value="Subscribe" id="subscribe">
        <a class="popup-close" data-popup-close="popup-1" style="color: #fff;" href="#">x</a>
    </div>
</div>

<style type="text/css">
/* Outer */
.popup {
    width:100%;
    height:100%;
    display:none;
    position:fixed;
    top:0px;
    left:0px;
    background:rgba(0,0,0,0.75);
}

/* Inner */
.popup-inner {
    max-width:700px;
    width:90%;
    padding:40px;
    position:absolute;
    top:50%;
    left:50%;
    -webkit-transform:translate(-50%, -50%);
    transform:translate(-50%, -50%);
    /*box-shadow:0px 2px 6px rgba(0,0,0,1);*/
    border-radius:3px;
    background: rgb(21, 173, 212);
    color: #fff;
}

/* Close Button */
.popup-close {
	width:30px;
	height:30px;
	padding-top:4px;
	display:inline-block;
	position:absolute;
	top:0px;
	right:0px;
	transition:ease 0.25s all;
	-webkit-transform:translate(50%, -50%);
	transform:translate(50%, -50%);
	border-radius:1000px;
	background:rgba(0,0,0,0.8);
	font-family:Arial, Sans-Serif;
	font-size:20px;
	text-align:center;
	line-height:100%;
	color:#fff;
}

.popup-close:hover {
	-webkit-transform:translate(50%, -50%) rotate(180deg);
	transform:translate(50%, -50%) rotate(180deg);
	background:rgba(0,0,0,1);
	text-decoration:none;
}

input[type="text"].popup-input, input[type="email"].popup-input {
	border-color: transparent;
}
input[type="text"].error-field, input[type="email"].error-field {
	border-color: red;
	background-color: #F6D3D3;
}
/* #Emerald Flat Button
==================================================*/
.emerald-flat-button {
  position: relative;
  vertical-align: top;
  width: 50%;
  height: 60px;
  padding: 0;
  font-size: 22px;
  color: white;
  text-align: center;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.25);
  background: #2ecc71;
  border: 0;
  border-bottom: 2px solid #28be68;
  cursor: pointer;
  -webkit-box-shadow: inset 0 -2px #28be68;
  box-shadow: inset 0 -2px #28be68;
  margin-right: auto;
  margin-left: auto;
}
.emerald-flat-button:active {
  top: 1px;
  outline: none;
  -webkit-box-shadow: none;
  box-shadow: none;
}
</style>
<script type="text/javascript">
	jQuery( function( $ ) {
		jQuery(document).ready(function() {
			//----- OPEN
			if ( ! checkCookie( 'subscribe' ) ) {
				$('[data-popup=popup-1]').fadeIn('slow');
			}

		    //----- CLOSE
		    $('[data-popup-close]').on('click', function(e)  {
		        var targeted_popup_class = jQuery(this).attr('data-popup-close');
		        $('[data-popup="' + targeted_popup_class + '"]').fadeOut(350);

		        e.preventDefault();
		    });

		    $('#subscribe').click(function(event) {
		    	var validator = false;
		    	if ( ! jQuery.trim( jQuery( '#name' ).val() ) ) {
		    		jQuery( '#name' ).addClass('error-field');
		    		validator = true;
		    	} else {
		    		jQuery( '#name' ).removeClass( 'error-field' );
		    	}

		    	if ( ! validateEmail( $('#email').val() ) ) {
		    		jQuery( '#email' ).addClass('error-field');
		    		validator = true;
		    	} else {
		    		jQuery( '#email' ).removeClass( 'error-field' );
		    	}

		    	if ( ! validator ) {
		    		showMessage( 'Please wait...', 0 );
		    		// Sending email.
		    		$.ajax({
		    			url: 'https://fast-hollows-4459.herokuapp.com/send',
		    			type: 'POST',
		    			dataType: 'json',
		    			crossDomain: true,
		    			data: {
		    				name: jQuery.trim( jQuery( '#name' ).val() ),
		    				email: $('#email').val()
		    			},
		    		})
		    		.done(function( response ) {
		    			setCookie( 'subscribe', 'true', 30 );
		    			showMessage( response.message, response.success );
		    			$('[data-popup=popup-1]').delay( 2500 ).fadeOut('slow');
		    		})
		    		.fail(function( response ) {
		    			showMessage( response.message, response.success );
		    		});
		    	}
		    });

		    function validateEmail( email ) {
		    	var regex = /^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;
		    	return regex.test( email );
		    }

		    function setCookie( name, value, expireDate ) {
		    	var date = new Date();
		    	date.setTime( date.getTime() + ( expireDate * 24 * 60 * 60 * 1000 ) );
		    	var expires = "expires=" + date.toGMTString();
		    	document.cookie = name + "=" + value + "; " + expires;
		    }

		    function checkCookie( cname ) {
		        var name = cname + "=";
		        var ca = document.cookie.split(';');
		        if ( '' !== ca[0] ) {
		        	return true;
		        }
		        return false;
		    }

		    function showMessage( message, type ) {
		    	jQuery( '#popup-message' ).css( 'padding', '3px' );
		    	jQuery( '#popup-message' ).html('');
		    	jQuery('#popup-message' ).html( message );
		    	jQuery( '#popup-message' ).show();
		    	if ( 1 === type ) {
		    		jQuery( '#popup-message' ).css( 'border', '1px solid rgb(60, 221, 60)' );
		    	} else {
		    		jQuery( '#popup-message' ).css( 'border', '1px solid rgb(221, 60, 91)' );
		    	}
		    }

		});
	});
</script>